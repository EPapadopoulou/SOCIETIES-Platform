<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <p:contextMenu for="preferenceTree">
        <p:menuitem value="Add Condition" disabled="true"/>
        <p:menuitem value="Add Outcome" disabled="true"/>

        <p:menuitem value="Edit"
                    update="editConditionDialog"
                    actionListener="#{profileSettings.editSelectedNode}"
                    oncomplete="#{p:widgetVar('editConditionDialog')}.show()"/>

        <p:menuitem value="Delete" update="preferenceTree"
                    actionListener="#{profileSettings.deleteSelectedNode}"/>
    </p:contextMenu>


    <p:dialog id="editConditionDialog" header="Edit Condition" modal="true" appendToBody="true" closeOnEscape="true"
              dynamic="true">
        <p:panelGrid columns="2" rendered="#{profileSettings.conditionToEdit ne null}">
            <f:facet name="header">
                Edit Condition
            </f:facet>

            <h:outputLabel for="conditionName" value="Condition name: *"/>
            <p:inputText id="conditionName" value="#{profileSettings.conditionToEdit.name}"
                         required="true" label="Condition name"/>

            <h:outputLabel for="conditionOperator" value="Condition operator: *"/>
            <p:selectOneMenu value="#{profileSettings.conditionToEdit.operator}" effect="fade" id="conditionOperator">

                <f:selectItems value="#{profileSettings.conditionOperators}"
                               var="item"
                               itemLabel="#{item.description}"
                               itemValue="#{item.operation}"
                               itemDescription="#{item.description}"/>
            </p:selectOneMenu>

            <h:outputLabel for="conditionValue" value="Condition value: *"/>
            <p:inputText id="conditionValue" value="#{profileSettings.conditionToEdit.value}"
                         required="true" label="Condition value"/>

            <f:facet name="footer">
                <p:commandButton value="Save" icon="ui-icon-check" style="margin:0"
                                 actionListener="#{profileSettings.savePreferenceState}"
                                 update="preferenceTree"/>
                <p:commandButton value="Cancel" icon="ui-icon-check" style="margin:0"/>
            </f:facet>
        </p:panelGrid>

        <p:panelGrid columns="2" rendered="#{profileSettings.outcomeToEdit ne null}">
            <f:facet name="header">
                Edit Outcome
            </f:facet>

            <h:outputLabel for="outcomeValue" value="#{profileSettings.outcomeToEdit.parameterName} *"/>
            <p:inputText id="outcomeValue" value="#{profileSettings.outcomeToEdit.value}"
                         required="true" label="Outcome value"/>

            <f:facet name="footer">
                <p:commandButton value="Save" icon="ui-icon-check" style="margin:0"
                                 actionListener="#{profileSettings.savePreferenceState}"
                                 update="preferenceTree"
                                 oncomplete="#{p:widgetVar('editConditionDialog')}.hide()"/>
                <p:commandButton value="Cancel" icon="ui-icon-check" style="margin:0" type="button"
                                 onclick="#{p:widgetVar('editConditionDialog')}.hide()"/>
            </f:facet>
        </p:panelGrid>
    </p:dialog>

    <p:confirmDialog id="confirmDeleteConditionDialog"
                     message="Are you sure you want to delete this condition?"
                     header="Confirm delete" severity="alert">

        <p:commandButton value="Yes Sure" update="messages,preferenceTree"
                         actionListener="#{profileSettings.deleteSelectedNode}"
                         oncomplete="#{p:widgetVar('confirmDeleteConditionDialog')}.hide()"/>
        <p:commandButton value="Not Yet" type="button"
                         onclick="#{p:widgetVar('confirmDeleteConditionDialog')}.hide()"/>

    </p:confirmDialog>
</ui:composition>
